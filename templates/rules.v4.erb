# Generated by Puppet - do not edit
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p icmp -j ACCEPT
-A INPUT -i lo -j ACCEPT
<% permit_in.each do |i| -%>
-A INPUT -p tcp -m tcp --dport <%= i %> -j ACCEPT
<% end -%>
<% limit_out.each do |l| -%>
-A OUTPUT -p tcp --dport <%= l['port'] %> -m state --state NEW -m limit --limit <%= l['rate'] %> --limit-burst <%= l['burst'] %> -j ACCEPT
-A OUTPUT -p tcp --dport <%= l['port'] %> -o eth0 -m state --state NEW -j DROP
<% end -%>
-A INPUT -j REJECT --reject-with icmp-port-unreachable
COMMIT
